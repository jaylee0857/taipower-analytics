<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>台灣電力公司</title>

    <!-- bootstrap -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
        integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <!-- font-awesome CDN -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.css">
    <!-- layout -->
    <link rel="stylesheet" href="./css/template.css">
    <!-- page css  -->
    <link rel="stylesheet" href="./css/03-attitude_test_result.css">

</head>

<body>
    <nav id="nav_bar_area" class="">
        <div class="container">
            <div class="mask"></div>
            <div class="row justify-content-between ">
                <div class="col-9 col-xl-5 d-flex align-items-center">
                    <a href="index.html" class="nav_logo">
                        <img width="100%" src="./img/template/owl.png" alt="貓頭鷹png">
                    </a>
                    <a href="index.html">
                        <h1>用電診斷中心</h1>
                    </a>
                </div>
                <div class="col  d-xl-flex align-items-center phone_style_absolute">
                    <ul class="d-block d-xl-flex list_bar">
                        <li>
                            <a href="#">家庭及小商店</a>
                        </li>
                        <li>
                            <a href="#">商辦服務業</a>
                        </li>
                        <li>
                            <a href="#">製造業</a>
                        </li>
                    </ul>
                    <div class="d-flex btn_bar justify-content-center">
                        <a href="#">
                            <div class="btn_area">
                                <div class="icon"></div>
                                <span>登入</span>
                            </div>
                        </a>
                        <a href="#">
                            <div class="btn_area">
                                <span>加入會員</span>
                            </div>
                        </a>
                    </div>
                </div>
                <div class="d-flex phone_style_absolute link">
                    <a href="#">
                        <div class="youtube_photo">
                            <i class="fab fa-youtube"></i>
                        </div>
                    </a>
                    <a href="#">
                        <div class="fb_photo">
                            <i class="fab fa-facebook"></i>
                        </div>
                    </a>
                </div>
                <div class="nav_hamburger d-block d-xl-none">
                    <span></span>
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            </div>
        </div>
    </nav>
    <!-- page_content start -->
    <main>
        <section id="topline">
            <div class="container">
                <!-- 麵包屑 -->
                <div aria-label="breadcrumb">
                    <ol class="breadcrumb">
                        <li class="breadcrumb-item">
                            <svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="home"
                                class="svg-inline--fa fa-home fa-w-18" role="img" xmlns="http://www.w3.org/2000/svg"
                                viewBox="0 0 576 512">
                                <path fill="currentColor"
                                    d="M280.37 148.26L96 300.11V464a16 16 0 0 0 16 16l112.06-.29a16 16 0 0 0 15.92-16V368a16 16 0 0 1 16-16h64a16 16 0 0 1 16 16v95.64a16 16 0 0 0 16 16.05L464 480a16 16 0 0 0 16-16V300L295.67 148.26a12.19 12.19 0 0 0-15.3 0zM571.6 251.47L488 182.56V44.05a12 12 0 0 0-12-12h-56a12 12 0 0 0-12 12v72.61L318.47 43a48 48 0 0 0-61 0L4.34 251.47a12 12 0 0 0-1.6 16.9l25.5 31A12 12 0 0 0 45.15 301l235.22-193.74a12.19 12.19 0 0 1 15.3 0L530.9 301a12 12 0 0 0 16.9-1.6l25.5-31a12 12 0 0 0-1.7-16.93z">
                                </path>
                            </svg>
                            <a href="#">首頁</a>
                        </li>
                        <li class="breadcrumb-item">
                            <a href="#">節電態度測驗</a>
                        </li>
                    </ol>
                </div>
            </div>
        </section>
        <section id="page_title" class="block-title">
            <div class="container ">
                <div class="row title-text">
                    <h2 class="col-12">節電態度測驗</h2>
                    <img class="col-12" src="./img/02-analysis/title-border.png" alt="">
                </div>
            </div>
        </section>
        <section id="notice">
            <div class="container">
                <div class="row">
                    <div class="col-12 result_text">
                        <span>王大明</span>
                        您的測驗結果
                    </div>
                    <div class="col-12 analysis_text">
                        <div class="background_color">
                            <div class="photo">
                                <img src="./img/03-attitude_test/2020-05-29-25.png" alt="貓頭鷹">
                                <img src="./img/03-attitude_test/2020-05-29-23.png" alt="貓頭鷹" hidden>
                                <img src="./img/03-attitude_test/2020-05-29-24.png" alt="貓頭鷹" hidden>
                                <img src="./img/03-attitude_test/2020-05-29-26.png" alt="貓頭鷹" hidden>
                            </div>  
                            <div class="text">
                                <h2>高度興趣立即實踐型</h2>
                                <p>用戶容易受到焦點話題吸引。廣告內容可加強熱門流行話題，讓用戶感受節電將會是主流趨勢。</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-12 col-xl-8 notice_text">
                        <p>想要了解熱門節電手法嗎？歡迎參考<a href="#">台電影音網</a>。</p>
                    </div>
                </div>
            </div>
        </section>
        <section id="chart">
            <div class="container">
                <div class="row">
                    <div class="title col-12">分析結果：</div>
                    <div class="col-12 kit position-relative ">
                        <canvas id="myChart" width="400" height="400"></canvas>
                        <div id="legend"></div>
                        <div id="chartjs-tooltip" class="center position-absolute">
                            <table>
                                <thead></thead>
                                <tbody>
                                    <tr>
                                        <td class="chart_title"><span></span>勤奮實踐型:
                                            25.8%</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        <section id="analysis">
            <div class="container">
                <div class="row">
                    <div class="col-12 title">
                        想更了解自身用電與同類型用電比較??
                    </div>
                    <div class="col-12 photo_flex">
                        <div class="photo">
                            <div class="text">聰明用電分析</div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>
    <!-- page_content end -->

    <footer>
        <!-- background-image footer_background start-->
        <div class="footer_background">
            <div class="background_img">
                <img width="100%" src="./img/05-sign_up/content_background.png" alt="">
            </div>
            <div class="background_color"></div>
            <video class="footer_white_mp4" src="./MP4/Footer-green.mp4" autoplay muted loop></video>
            <!-- <div class="animation" data-name="05-Footer" data-path='./json/05-Footer/05-Footer.json'></div> -->
            <!-- <img width="100%" src="./img/template/footer_background.png" alt=""> -->
        </div>
        <!-- background-image footer_background end-->

        <div class="footer_content">
            <div class="footer_info container">
                <div class="row">
                    <div class="info_area col-9">
                        <div class="important_info">
                            <span><a href="#">隱私權政策</a></span>
                            <span><a href="#">政府網站資料開放宣告</a></span>
                        </div>
                        <div class="secondary_info">
                            <div class="d-flex flex-wrap">
                                <span>地址：臺北市羅斯福路三段242號</span>
                                <span>郵遞區號：10016</span>
                                <span>總機：02-23651234</span>
                                <span>24小時客服專線：1911 <br class="d-block d-md-none">（免付費，公共電話除外，通話時間限制5分鐘）</span>
                                <span>政風檢舉電話：02-23667364</span>
                            </div>
                        </div>

                    </div>
                    <div class="col d-md-flex d-block  flex-wrap btn_area">
                        <a href="#">
                            <div class="wordS_btn">台電官網</div>
                        </a>
                        <a href="#">
                            <div class="wordS_btn">意見信箱</div>
                        </a>
                        <a href="#">
                            <div class="add_icon_btn">
                                <i class="fab fa-facebook-square"></i>
                                <span>電力粉絲團</span>
                            </div>
                        </a>
                        <a href="#">
                            <div class="add_icon_btn">
                                <i class="fab fa-youtube"></i>
                                <span>台電影音網</span>
                            </div>
                        </a>
                    </div>
                </div>
            </div>
            <!-- background-image iceberg star-->
            <div class="green_background"></div>
            <div class="ice_left"></div>
            <div class="ice_right"></div>
            <!-- background-image iceberg over-->
        </div>
    </footer>
   
    <!-- goTop start-->
    <a id="goTop" href="#top">
        <p>TOP</p>
    </a>
    <!-- goTop end-->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bodymovin/5.6.8/lottie.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.5.1.js"
        integrity="sha256-QWo7LDvxbWT2tbbQ97B53yJnYU3WhH/C8ycbRAkjPDc=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
        integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
        crossorigin="anonymous"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js"
        integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6"
        crossorigin="anonymous"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.3/Chart.min.js"></script>


    <script src="https://cdn.jsdelivr.net/jquery.validation/1.16.0/jquery.validate.min.js"></script>
    <script src="./js/template.js"></script>
    <script src="./js/index.js"></script>

    <script>
        var ctx = document.getElementById('myChart');
        var myChart = new Chart(ctx, {
            type: 'doughnut',
            data: {
                labels: ['智慧實踐型', '勤奮實踐型', '合理實踐型', '高度興趣立即實踐型'],
                datasets: [
                    {
                        label: '# of Votes',
                        data: [14.2, 42.9, 17.2, 25.8],
                        backgroundColor: [
                            'rgba(117, 219, 204, 1)',
                            'rgba(225, 137, 72, 1)',
                            'rgba(239, 132, 167, 1)',
                            'rgba(255, 220, 0, 1)',
                        ],
                        borderColor: [
                        'rgba(117, 219, 204, 1)',
                            'rgba(225, 137, 72, 1)',
                            'rgba(239, 132, 167, 1)',
                            'rgba(255, 220, 0, 1)',
                        ],
                    }
                ]
            },
            options: {
                legend: {
                    display: false,
                    position: 'right',
                    fontFamily: "'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",
                    labels: {
                        boxWidth: 15,
                        boxHeight: 100,
                    }
                },
                tooltips: {
                    enabled: false,
                    custom: function (tooltipModel) {

                        // Tooltip Element
                        var tooltipEl = document.getElementById('chartjs-tooltip');

                        // Hide if no tooltip
                        if (tooltipModel.opacity === 0) {
                            tooltipEl.style.opacity = 0;
                            return;
                        }

                        // Set caret Position
                        tooltipEl.classList.remove('above', 'below', 'no-transform');
                        if (tooltipModel.yAlign) {
                            tooltipEl.classList.add(tooltipModel.yAlign);
                        } else {
                            tooltipEl.classList.add('no-transform');
                        }

                        function getBody(bodyItem) {
                            return bodyItem.lines;
                        }

                        // Set Text
                        if (tooltipModel.body) {
                            var titleLines = tooltipModel.title || [];
                            var bodyLines = tooltipModel.body.map(getBody);


                            var innerHtml = '<thead>';

                            titleLines.forEach(function (title) {
                                innerHtml += '<tr><th>' + title + '</th></tr>';
                            });
                            innerHtml += '</thead><tbody>';

                            bodyLines.forEach(function (body, i) {
                                var colors = tooltipModel.labelColors[i];
                                var style = 'background:' + colors.backgroundColor;
                                style += '; border-color:' + colors.borderColor;
                                style += '; border-width: 2px';
                                style += '; width: 20px';
                                style += '; height: 20px';
                                style += '; border-radius: 5px';
                                style += '; margin-right: 7px;';
                                var span = '<div style="' + style + '"></div>';
                                innerHtml += '<tr><td class= "chart_title">' + span + body + '%</td></tr>';
                            });
                            innerHtml += '</tbody>';

                            var tableRoot = tooltipEl.querySelector('table');
                            tableRoot.innerHTML = innerHtml;
                        }

                        // `this` will be the overall tooltip
                        var position = this._chart.canvas.getBoundingClientRect();

                        // Display, position, and set styles for font
                        tooltipEl.style.opacity = 1;
                        tooltipEl.style.position = 'absolute';
                        innerWidth
                        if(innerWidth > 1199){
                            tooltipEl.style.left = tooltipModel.caretX + 'px';
                             tooltipEl.style.top = tooltipModel.caretY + 'px';
                        }
                        else if (innerWidth > 768){
                            tooltipEl.style.left = (tooltipModel.caretX - 130)+ 'px';
                            tooltipEl.style.top = tooltipModel.caretY + 'px';
                        }
                        else{
                            tooltipEl.style.left = (tooltipModel.caretX - 180 )+ 'px';
                            tooltipEl.style.top = (tooltipModel.caretY - 20)+ 'px';
                        }
                        tooltipEl.style.fontFamily = tooltipModel._bodyFontFamily;
                        tooltipEl.style.fontSize = tooltipModel.bodyFontSize + 'px';
                        tooltipEl.style.fontStyle = tooltipModel._bodyFontStyle;
                        tooltipEl.style.padding = tooltipModel.yPadding + 'px ' + tooltipModel.xPadding + 'px';
                        tooltipEl.style.pointerEvents = 'none';
                    }
                }

            }
        });
        // myChart.canvas.style.height = '400px';
        // myChart.canvas.style.width = '800px';

        $(window).resize(function () {
            myChart.reDraw();
           
        })

        // console.log(myChart.data.datasets[0].data);

        var myLegendContainer = document.getElementById("legend");
        // generate HTML legend
        myLegendContainer.innerHTML = myChart.generateLegend();
        $(".0-legend li").each(function( index, value ) {
            value.innerHTML += " " + myChart.data.datasets[0].data[index] +"%"
            console.log(value.innerHTML);
        });
       

        // bind onClick event to all LI-tags of the legend
        var legendItems = myLegendContainer.getElementsByTagName('li');
        for (var i = 0; i < legendItems.length; i += 1) {
            legendItems[i].addEventListener("click", legendClickCallback, false);
        }


        function legendClickCallback(event) {
            event = event || window.event;

            var target = event.target || event.srcElement;
            while (target.nodeName !== 'LI') {
                target = target.parentElement;
            }
            var parent = target.parentElement;
            var chartId = parseInt(parent.classList[0].split("-")[0], 10);
            var chart = Chart.instances[chartId];
            var index = Array.prototype.slice.call(parent.children).indexOf(target);
            var meta = chart.getDatasetMeta(0);
            console.log(index);
            var item = meta.data[index];

            if (item.hidden === null || item.hidden === false) {
                item.hidden = true;
                target.classList.add('hidden');
            } else {
                target.classList.remove('hidden');
                item.hidden = null;
            }
            chart.update();
        }
    </script>
    <script>
        
    </script>
</body>


</html>